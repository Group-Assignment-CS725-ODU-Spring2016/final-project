<!DOCTYPE html>
<meta charset="utf-8">
<style>
.axis path,
.axis line {
	fill: none;
	stroke: black;
	shape-rendering: crispEdges;
}
.axis text {
	font-family: sans-serif;
	font-size: 11px;
}

rect {
	-moz-transition: all 0.3s;
	-webkit-transition: all 0.3s;
	-o-transition: all 0.3s;
	transition: all 0.3s;
}
rect:hover{
	fill: orange;
}
</style>
<body>
    <button id="sort" onclick="sortBars()">Sort</button>
    <button id="reset" onclick="reset()">Reset</button>

<script src="d3.min.js"></script>

<script>
var w = 600;
var h = 250;

var dataset = [ 
	{ date: 0, price: 5 },
	{ date: 1, price: 10 },
	{ date: 2, price: 22 },
	{ date: 3, price: 19 },
	{ date: 4, price: 21 }
];

var xScale = d3.scale.ordinal()
				.domain(d3.range(dataset.length))
				.rangeRoundBands([0, w], 0.05); 

var yScale = d3.scale.linear()
				.domain([0, d3.max(dataset, function(d) {return d.price;})])
				.range([0, h]);

var key = function(d) {
	return d.date;
};

//Create SVG element
var svg = d3.select("body")
			.append("svg")
			.attr("width", w)
			.attr("height", h);

//Create bars
svg.selectAll("rect")
   .data(dataset, key)
   .enter()
   .append("rect")
   .attr("x", function(d, i) {
		return xScale(i);
   })
   .attr("y", function(d) {
		return h - yScale(d.price);
   })
   .attr("width", xScale.rangeBand())
   .attr("height", function(d) {
		return yScale(d.price);
   })
   .attr("fill", function(d) {
		return "rgb(0, 0, " + (d.price * 10) + ")";
   })

	
var sortOrder = false;
var sortBars = function () {
    sortOrder = !sortOrder;
   
    sortItems = function (a, b) {
        if (sortOrder) {
            return a.price - b.price;
        }
        return b.price - a.price;
    };
    svg.selectAll("rect")
        .sort(sortItems)
        .transition()
        .delay(function (d, i) {
        return i * 50;
    })
        .duration(1000)
        .attr("x", function (d, i) {
        return xScale(i);
    });

  
};
// Add the onclick callback to the button
d3.select("#sort").on("click", sortBars);
d3.select("#reset").on("click", reset);
function reset() {
	svg.selectAll("rect")
		.sort(function(a, b){
			return a.date - b.date;
		})
		.transition()
        .attr("x", function (d, i) {
        return xScale(i);
		});
};

</script>
